{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nlet limit = 15;\n\nconst searchParams = new URLSearchParams({\n\timage_type: 'photo',\n\torientation: 'horizontal',\n\tsafesearch: true,\n\tper_page: limit,\n});\n\naxios.defaults.baseURL = `https://pixabay.com/api/?key=38590711-cd4e1138b2603dfebaf6d7de9&`;\n\nexport async function pixabayApi(inputValue, page = 1) {\n\tif (inputValue.length === 0) {\n\t\treturn Promise.reject(\"Sorry, there are no images matching your search query. Please try again!\")\n\t}\n\n\tsearchParams.set(\"q\", inputValue.trim().toLowerCase());\n\tsearchParams.set(\"page\", page);\n\n\ttry {\n\t\tconst posts = await axios.get(searchParams.toString());\n\t\treturn posts.data;\n\t} catch(err) {\n\t\tiziToast.error({\n\t\t\tmessage: `${err}`,\n\t\t\tcloseOnClick: true,\n\t\t\tposition: \"topRight\",\n\t\t\tdisplayMode: 0,\n\t\t\tprogressBar: false,\n\t\t});\n\t}\n\n}\n\n\n","export function renderFunction(posts) {\n    const markup = posts.map(({ comments, downloads, likes,tags,\n        largeImageURL, previewURL, views }) => {\n\n        return `<li class=\"gallery-item\">\n                    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                    <img\n                        class=\"gallery-image\"\n                        src=\"${previewURL}\"\n                        alt=\"${tags}\"\n                        />\n                    </a>\n                    <div class=\"image-descriptions-container\">\n                        <div class=\"small-descriptions-container\">\n                            <p>Likes</p>\n                            <p>${likes}</p>\n                        </div>\n                        <div class=\"small-descriptions-container\">\n                            <p>Views</p>\n                            <p>${views}</p>\n                        </div>\n                        <div class=\"small-descriptions-container\">\n                            <p>Comments</p>\n                            <p>${comments}</p>\n                        </div>\n                        <div class=\"small-descriptions-container\">\n                            <p>Downloads</p>\n                            <p>${downloads}</p>\n                        </div>\n                    </div>\n                    </li>\n    `\n    })\n\n    return markup.join(\"\");\n\n}\n\n","import { pixabayApi } from \"./js/pixabay-api\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { renderFunction } from \"./js/render-functions\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst submitForm = document.querySelector('form');\nconst gallery = document.querySelector('.gallery');\nconst input = document.querySelector('input[type=\"text\"]');\nconst loader = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more-button');\n\nconst instancesOptions = {\n    closeOnClick: true,\n    position: \"topRight\",\n    displayMode: 0,\n    progressBar: false,\n    backgroundColor: '#EF4040',\n    messageColor: 'white',\n    iconColor: 'white',\n    maxWidth: '432px',\n};\n\nconst { closeOnClick, position, displayMode, progressBar,\n    backgroundColor, messageColor, iconColor, maxWidth,} = instancesOptions;\n\nlet lightbox;\nlet page;\n\nconst handleLoadMore = () => {\n    page += 1;\n    loader.classList.add('visible');\n    fetchWithTimeout(page);\n\n}\n\nconst handleSubmit = (e) => {\n    e.preventDefault();\n    page = 1;\n    gallery.innerHTML = \"\";\n    loader.classList.add('visible');\n    fetchWithTimeout(page);\n\n};\n\nsubmitForm.addEventListener('submit', handleSubmit);\nloadMoreButton.addEventListener('click', handleLoadMore);\n\nfunction fetchWithTimeout(page) {\n    if (lightbox) {\n        lightbox.refresh();\n    }\n    loadMoreButton.classList.remove('visible');\n    setTimeout(async function () {\n        try {\n            const posts = await pixabayApi(input.value, page);\n                if (posts.hits.length === 0)\n                    throw new Error(\"Sorry, there are no images matching your search query. Please try again!\");\n                let top = 0;\n                if (page > 1) {\n                    const rect = gallery.firstChild.getBoundingClientRect();\n                    top = rect.height * 2;\n                }\n\n                gallery.insertAdjacentHTML(\"beforeend\", renderFunction(posts.hits));\n                window.scrollBy({ top, behavior: \"smooth\" });\n                lightbox = new SimpleLightbox('.gallery a', {\n                    captions: true,\n                    captionSelector: 'img',\n                    captionPosition: 'outside',\n                    captionDelay: 250,\n                    overlayOpacity: 0.8,\n                    styles: '../css/styles.css',\n                    captionsData: 'alt'\n                }\n                )\n                if ((posts.total - posts.hits.length * page) > posts.hits.length) {\n                    loadMoreButton.classList.add('visible');\n                } else {\n                    loadMoreButton.classList.remove('visible');\n                    iziToast.info({\n                        message: \"We're sorry, but you've reached the end of search results.\", iconColor,\n                        maxWidth, closeOnClick, position, displayMode, progressBar,\n                    })\n                }\n        } catch (err) {\n            iziToast.error({\n            message: `${err.message ? err.message : err}`, closeOnClick: true, position,\n            displayMode, progressBar, backgroundColor, messageColor, iconColor, maxWidth,\n        })\n        } finally {\n            loader.classList.remove('visible')\n        }\n        \n    }, 1000);\n}\n"],"names":["limit","searchParams","axios","pixabayApi","inputValue","page","err","iziToast","renderFunction","posts","comments","downloads","likes","tags","largeImageURL","previewURL","views","submitForm","gallery","input","loader","loadMoreButton","instancesOptions","closeOnClick","position","displayMode","progressBar","backgroundColor","messageColor","iconColor","maxWidth","lightbox","handleLoadMore","fetchWithTimeout","handleSubmit","e","top","SimpleLightbox"],"mappings":"+vBAIA,IAAIA,EAAQ,GAEZ,MAAMC,EAAe,IAAI,gBAAgB,CACxC,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUD,CACX,CAAC,EAEDE,EAAM,SAAS,QAAU,mEAElB,eAAeC,EAAWC,EAAYC,EAAO,EAAG,CACtD,GAAID,EAAW,SAAW,EACzB,OAAO,QAAQ,OAAO,0EAA0E,EAGjGH,EAAa,IAAI,IAAKG,EAAW,KAAI,EAAG,aAAa,EACrDH,EAAa,IAAI,OAAQI,CAAI,EAE7B,GAAI,CAEH,OADc,MAAMH,EAAM,IAAID,EAAa,SAAQ,CAAE,GACxC,IACb,OAAOK,EAAK,CACZC,EAAS,MAAM,CACd,QAAS,GAAGD,CAAG,GACf,aAAc,GACd,SAAU,WACV,YAAa,EACb,YAAa,EAChB,CAAG,CACH,CAEA,CCpCO,SAASE,EAAeC,EAAO,CAkClC,OAjCeA,EAAM,IAAI,CAAC,CAAE,SAAAC,EAAU,UAAAC,EAAW,MAAAC,EAAM,KAAAC,EACnD,cAAAC,EAAe,WAAAC,EAAY,MAAAC,KAEpB;AAAA,oDACqCF,CAAa;AAAA;AAAA;AAAA,+BAGlCC,CAAU;AAAA,+BACVF,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAMFD,CAAK;AAAA;AAAA;AAAA;AAAA,iCAILI,CAAK;AAAA;AAAA;AAAA;AAAA,iCAILN,CAAQ;AAAA;AAAA;AAAA;AAAA,iCAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,KAKrC,EAEa,KAAK,EAAE,CAEzB,CC7BA,MAAMM,EAAa,SAAS,cAAc,MAAM,EAC1CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAQ,SAAS,cAAc,oBAAoB,EACnDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAAc,mBAAmB,EAE3DC,EAAmB,CACrB,aAAc,GACd,SAAU,WACV,YAAa,EACb,YAAa,GACb,gBAAiB,UACjB,aAAc,QACd,UAAW,QACX,SAAU,OACd,EAEM,CAAE,aAAAC,EAAc,SAAAC,EAAU,YAAAC,EAAa,YAAAC,EACzC,gBAAAC,EAAiB,aAAAC,EAAc,UAAAC,EAAW,SAAAC,CAAU,EAAGR,EAE3D,IAAIS,EACA1B,EAEJ,MAAM2B,EAAiB,IAAM,CACzB3B,GAAQ,EACRe,EAAO,UAAU,IAAI,SAAS,EAC9Ba,EAAiB5B,CAAI,CAEzB,EAEM6B,EAAgBC,GAAM,CACxBA,EAAE,eAAgB,EAClB9B,EAAO,EACPa,EAAQ,UAAY,GACpBE,EAAO,UAAU,IAAI,SAAS,EAC9Ba,EAAiB5B,CAAI,CAEzB,EAEAY,EAAW,iBAAiB,SAAUiB,CAAY,EAClDb,EAAe,iBAAiB,QAASW,CAAc,EAEvD,SAASC,EAAiB5B,EAAM,CACxB0B,GACAA,EAAS,QAAS,EAEtBV,EAAe,UAAU,OAAO,SAAS,EACzC,WAAW,gBAAkB,CACzB,GAAI,CACA,MAAMZ,EAAQ,MAAMN,EAAWgB,EAAM,MAAOd,CAAI,EAC5C,GAAII,EAAM,KAAK,SAAW,EACtB,MAAM,IAAI,MAAM,0EAA0E,EAC9F,IAAI2B,EAAM,EACN/B,EAAO,IAEP+B,EADalB,EAAQ,WAAW,sBAAuB,EAC5C,OAAS,GAGxBA,EAAQ,mBAAmB,YAAaV,EAAeC,EAAM,IAAI,CAAC,EAClE,OAAO,SAAS,CAAE,IAAA2B,EAAK,SAAU,QAAQ,CAAE,EAC3CL,EAAW,IAAIM,EAAe,aAAc,CACxC,SAAU,GACV,gBAAiB,MACjB,gBAAiB,UACjB,aAAc,IACd,eAAgB,GAChB,OAAQ,oBACR,aAAc,KAClC,CACA,EACqB5B,EAAM,MAAQA,EAAM,KAAK,OAASJ,EAAQI,EAAM,KAAK,OACtDY,EAAe,UAAU,IAAI,SAAS,GAEtCA,EAAe,UAAU,OAAO,SAAS,EACzCd,EAAS,KAAK,CACV,QAAS,6DAA8D,UAAAsB,EACvE,SAAAC,EAAU,aAAAP,EAAc,SAAAC,EAAU,YAAAC,EAAa,YAAAC,CAClD,CAAA,EAEZ,OAAQpB,EAAK,CACVC,EAAS,MAAM,CACf,QAAS,GAAGD,EAAI,QAAUA,EAAI,QAAUA,CAAG,GAAI,aAAc,GAAM,SAAAkB,EACnE,YAAAC,EAAa,YAAAC,EAAa,gBAAAC,EAAiB,aAAAC,EAAc,UAAAC,EAAW,SAAAC,CACvE,CAAA,CACT,QAAkB,CACNV,EAAO,UAAU,OAAO,SAAS,CAC7C,CAEK,EAAE,GAAI,CACX"}